<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/html; charset=UTF-8" http-equiv="content-type" /><meta content="Introducing gargamel, generating changelog based on git commits in multiple formats" name="description" /><meta content="git, changelog, release, release notes, github, CI, gargamel, clojure, MailOnline" name="keywords" /><meta content="Benedek Fazekas" name="author" /><link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.1/css/font-awesome.min.css" rel="stylesheet" type="text/css" /><link href="//fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans" rel="stylesheet" type="text/css" /><link href="/bootstrap.min.css" rel="stylesheet" type="text/css" /><link href="/custom.css" rel="stylesheet" type="text/css" /><title>Laziness driven changelogs</title></head><body><div class="content"><div class="container"><div class="row"><div class="col-md-8"><div class="page-header"><h1>Laziness driven changelogs</h1></div><div class="entry"><p>At the MailOnline we have not been doing <a href="https://twitter.com/javame/status/489338291494207488">microservices</a> exactly but something definitely far from big, monolithic applications. This resulted in quite a few applications across the board. Many written in clojure or in node.js, javascript for the browser, or some other language. We developers take care of releasing our software which is perhaps the right way to go most of the times, using some <a href="http://martinfowler.com/articles/continuousIntegration.html">CI</a> tool and always trying to push for <a href="http://martinfowler.com/bliki/ContinuousDelivery.html">continuous delivery</a>. Nevertheless the time had come when we were asked to provide some human readable information about the versions of the software we release. The request come from multiple sources: devs, devops and technical management all wanted this info. For a short time we could repel the requests by pointing people to our CI tool and/or gitlogs either in the command line or on github which we use to host almost all our projects -- rest is on bitbucket, just to make things even harder to track. On the top of that we use multiple issue tracking systems, yeah I know, don't ask: historical reasons. As these issues have very valuable information on what we are working on they should be referenced in these changelogs too.</p><p>When we realised that we can't really escape the changelog, release note request and to track things would actually help ourselves too we had practically to ways to go: either write these changelogs manually or write some code to generate them for us. Luckily almost from the beginning we were fairly good writing commit messages -- I read that some people actually use git hooks to validate commit messages and enforce certain rules: we are not that good but everybody in the group writes a meaningful one liner at least, referencing github or JIRA issues using tags like <code>[wip]</code> or <code>[refactor]</code>. That is fairly good base to build on.</p><p>On an other note a long annoyance of mine the release creation on github: why, oh why can't you automatically generate some changelog on github based on your commit messages? I am sure that would not work for everybody who wants to use the release facility on github but it should do it for many projects. So first round: let's do a bit of googling if the tool is already out there. Well... kinda... <a href="https://pypi.python.org/pypi/gitchangelog">gitchangelog</a> looks like exactly what we need. But looking at its sample config file: not that sure anymore. So I basically figured writing something with a similar set of features with simpler config, less code and easy to use for any project but even easier for clojure projects would be fun.</p><p>Hence happened <a href="https://github.com/MailOnline/gargamel">gargamel</a> which can be used as a leiningen plugin or with its CLI interface. It accepts any git refs to generate a changelog in between or can generate release notes between the two latest occurrence of some tags with a specific format (for example <code>v\d\.\d\.\d</code>). It uses mustache templates to generate practically any output format (tested with html and markdown) and with simple <a href="https://github.com/MailOnline/gargamel/blob/master/gargamel.edn">configuration</a> based on regexes it generates custom sections and munges certain objects (like creating links to github/jira issues from issue references) in the commit messages. On the top of that it is able to create changelogs of project dependencies in projects where those dependencies are managed in a <a href="http://bower.io">bower.json</a> file.</p><p>So now we are able to plugin in change log and release note generation into our release process. We have two types of release note generation jobs on our CI tool: manual one where you can provide <code>from</code> and <code>to</code> git refs: this is used to generate changelog for release candidates and publish them in the appropriate chatrooms (we use <a href="https://slack.com/">slack</a> heavily) for affected people to review. And we have an automated release note generation step which runs right after our production release. Integrating gargamel with CI and slack is the real win in this story. On the top of that on those open source projects I am involved in I can use gargamel now to create markdown changelogs for github releases. for example gargamel's own <a href="https://github.com/MailOnline/gargamel/releases/tag/release-050-20150113_1225">release notes</a>.</p></div></div><div class="col-md-4"></div><div class="col-md-12 post-tags">Tags: <a href="/tags/#git,">git, </a><a href="/tags/#changelog,">changelog, </a><a href="/tags/#release,">release, </a><a href="/tags/#release">release </a><a href="/tags/#notes,">notes, </a><a href="/tags/#github,">github, </a><a href="/tags/#CI,">CI, </a><a href="/tags/#gargamel,">gargamel, </a><a href="/tags/#clojure,">clojure, </a><a href="/tags/#MailOnline">MailOnline </a></div></div></div><script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=clj&amp;lang=ruby"></script><div class="footer"><div class="container"><div class="row"><div class="col-md-12"><p>Built with <a href="http://getbootstrap.com/">Bootstrap</a> and <a href="https://github.com/nakkaya/static">Static</a><br /><p>&copy; 2014-2016 Benedek Fazekas | <a href="https://github.com/benedekfazekas">@github</a> | <a href="https://twitter.com/bfazek">@twitter</a> | </p></p></div></div></div></div></div></body></html>